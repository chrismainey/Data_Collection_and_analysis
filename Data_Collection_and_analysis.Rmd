---
title: "Data Collection and analysis"
author: "Chris Mainey <chris.mainey@uhb.nhs.uk>"
date: "2020/03/05 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    chakra: libs/remark-latest.min.js
    css: "libs/HED.css"
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: center, middle


.pull-left[
## Data Collection and analysis
<br><br>
__Chris Mainey__ 
<br><br>
 Senior Statistical Intelligence Analyst 
<br>
Healthcare Evaluation Data (HED) 

.small[Univeristy Hospitals Birmingham NHS FT]
<br><br><br>
[www.hed.nhs.uk](https://www.hed.nhs.uk)
]

.pull-right[
<br><br><br><br><br><br><br>
<img src="https://github.com/chrismainey/Data_Collection_and_analysis/raw/master/assets/img/logo.png" width=220 fig.align="center">
<img src="https://github.com/chrismainey/Data_Collection_and_analysis/raw/master/assets/img/HI.png" width=250 fig.align="center">
<br><br>
<img src="https://github.com/chrismainey/Data_Collection_and_analysis/raw/master/assets/img/img-logo-uhb.bmp" width=250 fig.align="center">
]



<br><br><br><br><br>
<span style="font-size:14px !important;"> __&copy; Healthcare Evaluation Data (HED)__- part of Health Informatics, University Hospitals Birmingham NHS Foundation Trust.  
<b>NOT TO BE REPUBLISHED OR DISTRIBUTED WITHOUT CONSENT</b> </span>

---

## Healthcare Evaluation Data (HED)


.pull-left[
- Online hospital benchmarking system
- Statistical models and analysis tools
- Activity, Mortality, Readmissions, Length-of-Stay, Marketshare etc.
- Used by ~60 NHS and other organisations
- Training and support
<br><br>
- __Using national NHS hospital data__
]
.pull-right[
<br>
<img src="https://chrismainey.github.io/EARL_2019_presentation/assets/HED_system.png" width=300 height=200>
<img src="https://chrismainey.github.io/EARL_2019_presentation/assets/HED_system.png" width=300 height=200>
]

<a href="https://www.hed.nhs.uk">www.hed.nhs.uk </a>


---

# Overview

+ What are data?
+ How do we generate them?
+ What types of data are there:
 + Qualitative
 + Quantitative
+ Methods of analysis with QUantitative data
 + Summary statstics
 + Plotting
 + Uncertainty
 + NOrmal distribution
 + Standard Error and COnfidence intervals

---

# What are data?

---

# Data, Knowledge, Information?

---

# How do we generate data?

## Primary
+ We collect data about a thing:
 + Occurances of an event
 + Duration of something
 
## Secondary
+ We generate data as a by product, or reuse it for another purpose:
 + Using patient care records to build risk models
 + Using patient data 

---

# Types of information

Various theoretical frameworks for this, and we are not doing an in-depth study here.
Summarise into:

## Qualitative

## Quantitative


---

# Qualitative Data

# Interview, survey, feedback etc.


# Observational:
 + e.g. Ethnography

---

# Qualitative analysis

+ Understanding your pholosophical position
  + Realism, COnstructivism etc.
  
+ Identifying your data collection method
 + Sampling strategy
 
+ Record data, e.g. transcripts

+ Analysis methods
 + Formal, e.g. constant comparative methods
 + Will you 'code' and how will you do it?
 
Example Tools:
+ Nvivo


---
## Data types

Data can take various forms:
E.g. measurements, grouping factors, estimates, observations etc.

+ Different in terms of:
 + Storage
 + Methods for summary/processing
 + Interpretation
--

+ A few major groups of data types:
 + Numeric
 + Binary
 + Categorical
  

---

## Data types (2)

<span style="color:red; font-weight:bold;"> Numeric </span>:
+ <span style="color:DodgerBlue ; font-weight:bold;"> Continuous:</span> values that can be constantly divided with a possible number in between
  + E.g. height of a person could be 172, 173 or 172.5 cm
  + <span style="color:SandyBrown; font-size:18px;"> Examples in HI: </span>  physiological measurements like blood pressure
--

<br>
+ <span style="color:DodgerBlue ; font-weight:bold;"> Discrete:</span> values that can only take whole numbers, usually obtained by counting.
  + E.g. Number of patients seen in a clinic could be 35 or 36 but not 35.5
  + <span style="color:SandyBrown; font-size:18px;"> Examples in HI: </span> counts of patients, waiting time measured in whole minutes, length of stay measured in days (like HED/HES), number of patient episodes

---

## Data types (3)

<span style="color:red; font-weight:bold;"> Binary </span>:
+ Exclusive two state variable 
  + E.g. 0/1, yes/no, TRUE/FALSE
  + <span style="color:SandyBrown; font-size:18px;"> Examples in HI: </span>  Patient dead or alive?, true or false answer to survey, patient status for a genetic marker

<br>
<img src = "https://imgs.xkcd.com/comics/extrapolating.png" class="center">
<span class="center" style="font-size:12px; line-height: 1.2em; font-style: italic;"> <i> Taken from: </i> xkcd https://xkcd.com/605/ </span>

---

## Data types (4)

<span style="color:red; font-weight:bold;"> Categorical </span>:
+ <span style="color:DodgerBlue ; font-weight:bold;"> Nominal:</span> Categories without any notion of order
  + E.g. Hair Colour, Brand of car, Country of residence
  + <span style="color:SandyBrown; font-size:18px;"> Examples in HI: </span>  Ethnicity, Admission method, Treatment speciality 
--

+ <span style="color:DodgerBlue ; font-weight:bold;"> Ordinal:</span> Categories with order, but not linear like numeric 
  + E.g. Survey answers ‘Good, OK & Bad’.  There is order, but ‘OK’ ≠ ‘Bad’ x 2 and ‘Good’ ≠ ‘Bad’ + ‘OK’
  + <span style="color:SandyBrown; font-size:18px;"> Examples in HI: </span> Cancer stage, self-assessed patient answers like ‘is your health poor, OK or good,’  Age-groups <1, 1-16, 17-40 etc.


---

# Summarising Data
<br><br>
___“Dear informatics, I would like age of all patients admitted as an emergency to general medicine in December?”___

<br><br>

```{r ages, echo=FALSE, cache=TRUE}
ages<-c(75,81,59,70,64,67,66,54,68,72,80,66,70,76,75,52,59,52,86,56,51,59,72,61,53,72,75,69,64,55,74,54,61,74,86,53,68,69,76,58,59,79,59,69,91,55,59,68,58,70,68,60,89,54,85,76,56,56,84,91,90,87,90,85,54,76,91,79,53,62,72,69,75,76,76,76,63,85,76,85,67,63,91,63,64,69,63,60,57,83,69,60,58,70,59,85,68,85,56,79,85,76,76,73,60,87,57,67,72,92,58,55,54,71,90,55,58, 59,63,77,85,77,53,66,73,53,79,70,70,77,56,65,85,64,74,66,74,59,68,79,66,56,68,63,66,66,68,70,64,72,56,83,53,69,67,77,68,63,73,57,86,52,75,78,76,61,71,77,64,62,77,69,69,66,85,65,61,72,69,73,53,77,54,56,72,70,69,67,62,78,58,54,69,76,86,59,80,84,56,78,75,57,68,91,91)

ages
```

---

## How would you answer that question

- What is the question?
- Sending a list of numbers doesn’t answer the question
- How might we show this in a better way?
- Summary figures?



<br>
### Visualise:
- Scatter plots
- Histogram or Kernel Density (sounds more impressive than it is)
- Box plot


---

# Scatter plots  

.pull-left[
Plots and 'x' variable by a 'y' variable by point

### Why doesn't this help?

- We've only got one variable, not two
- No summary information
- We want to see some kind of distribution 

]

.pull-right[
```{r scatter, include=TRUE, fig.retina=2, fig.width=6, fig.height=6, fig.align = "center", dependson=ages}
plot(ages)

```

]


---

## Histograms and Bar Charts

.pull-left[
- Plot of binned counts

- Good way to visualise distribution

- Bin sizes can vary & do not have to be equal

- Bar charts are related, but do not share the ‘binning’ idea. Can be used with categorical
]

.pull-right[
```{r hist1, echo=FALSE, fig.align="center", fig.height=5, fig.retina=2, fig.width=5, dependson=ages}
library(ggplot2)
ggplot(as.data.frame(ages), aes(x=ages)) +
  geom_histogram(col="#F8766D", 
                 fill="#F8766D", alpha=0.5, binwidth = 1)+
  labs(title='Histogram of Ages, single-year bins')

```
]

---

### Histograms and Bar Charts (2) 
<br>

```{r hist2, include=TRUE, echo=FALSE, fig.retina=2, fig.width=10, fig.height=6, fig.align = "centre", dependson=ages, warning=FALSE, message=FALSE, fig.pos="b"}
library(gridExtra)
grid.arrange(

  ggplot(as.data.frame(ages), aes(x=ages)) +
  geom_histogram( col="#F8766D", fill="#F8766D", alpha=0.5, binwidth = 2)+
  labs(title='Histogram of Ages, two-year bins')
,
ggplot(as.data.frame(ages), aes(x=ages)) +
  geom_histogram(aes(y=..density..), col="#F8766D", fill="#F8766D", alpha=0.5, breaks =c(50, 55,60,65,70,75,80,95) )+
  labs(title='Histogram of Ages, variable bins')
, 

ncol=2)

```


---

## Kernel Density

.pull-left[
```{r kernel, echo=FALSE, fig.align="centre", fig.height=5, fig.retina=2, fig.width=5, dependson=ages}
ggplot(as.data.frame(ages), aes(x=ages)) +
  geom_density( col="yellowgreen", 
                fill="yellowgreen", alpha=0.5)+
  labs(title='Density of Ages')

```
]

.pull-right[
<br>
- Similar to a smoothed histogram

- Plots the probability density of data rather than counts values

- Conceptually harder, but nicer visualisation
]

---

## Box Plots

.pull-left[
<br><br>
__Box range is (“hinges”):__

+ 25th percentile
+ 75th percentile
+ Line is the median (50th percentile)
+ Whiskers extend hinge ± 1.5 * IQR
+ Outliers (further points) are represented
+ Terms will be explained in the following slides

]

.pull-right[

```{r box, echo=FALSE, fig.align="centre", fig.height=6, fig.retina=2, fig.width=5, dependson=ages}
ggplot(as.data.frame(ages), 
       aes(y=ages, x="ages", group ="ages"))+
  geom_boxplot()+
  labs(title='Box Plot of Ages')

```
]